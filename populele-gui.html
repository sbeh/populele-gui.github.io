<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Populele GUI</title>
</head>
<body>
<script>
async function go() {
try {
const serviceUuid = '0000ffa0-0000-1000-8000-00805f9b34fb'
const characteristicUuid = '0000dc86-0000-1000-8000-00805f9b34fb'
    
let bluetoothDevice = await navigator.bluetooth.requestDevice({
    filters: [{ name: 'populele' }],
    optionalServices: [serviceUuid]
})

let bluetoothServer = await bluetoothDevice.gatt.connect()

const service = await bluetoothServer.getPrimaryService(serviceUuid)
const characteristic = await service.getCharacteristic(characteristicUuid)

let i = 0
let ii = 1
let j = 1
let jj = -1
let k = 2
let kk = -1
let l = 3
let ll = -1

setInterval(() => {
try {
    console.log(i)
    characteristic.writeValue(new Uint8Array([
        0xf1,
        i > 9 ? 1<<(i-10) : 0, i > 1 && i < 10 ? 1<<(i-2) : 0, i < 2 ? 1<<(i+6) : 0,
        j > 9 ? 1<<(j-10) : 0, j > 1 && j < 10 ? 1<<(j-2) : 0, j < 2 ? 1<<(j+6) : 0,
        k > 9 ? 1<<(k-10) : 0, k > 1 && k < 10 ? 1<<(k-2) : 0, k < 2 ? 1<<(k+6) : 0,
        l > 9 ? 1<<(l-10) : 0, l > 1 && l < 10 ? 1<<(l-2) : 0, l < 2 ? 1<<(l+6) : 0,
        0x00, 0x00, 0x00,
        0x00, 0x00, 0x00,
    ]))
    i += ii
    if (ii > 0 && i == 17)
        ii = -1
    else if (ii < 0 && i == 0)
        ii = +1
    j += jj
    if (jj > 0 && j == 17)
        jj = -1
    else if (jj < 0 && j == 0)
        jj = +1
    k += kk
    if (kk > 0 && k == 17)
        kk = -1
    else if (kk < 0 && k == 0)
        kk = +1
    l += ll
    if (ll > 0 && l == 17)
        ll = -1
    else if (ll < 0 && l == 0)
        ll = +1
} catch(error) {
    document.write(error)
}
}, 80)
} catch(error) {
    document.write(error)
}
}
</script>
<button onclick="go()">Go</button>
</body>
</html>
