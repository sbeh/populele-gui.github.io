<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Populele GUI</title>
</head>
<body>
<script>
async function go() {
const serviceUuid = '0000ffa0-0000-1000-8000-00805f9b34fb'
const characteristicUuid = '0000dc86-0000-1000-8000-00805f9b34fb'
    
let bluetoothDevice = await navigator.bluetooth.requestDevice({
    filters: [{ name: 'populele' }],
    optionalServices: [serviceUuid]
})

let bluetoothServer = await bluetoothDevice.gatt.connect()

const service = await bluetoothServer.getPrimaryService(serviceUuid)
const characteristic = await service.getCharacteristic(characteristicUuid)

let i = 0
let j = 17
let k = 16
let l = 15
let ii = 1
setInterval(() => {
    characteristic.writeValue(new Uint8Array([
        0xf1,
        i < 2 ? 1<<(i+6) : 0, i > 9 ? 1<<(i-10) : 0, i > 1 && i < 10 ? 1<<(i-8) : 0,
        j < 2 ? 1<<(j+6) : 0, j > 9 ? 1<<(j-10) : 0, j > 1 && j < 10 ? 1<<(j-8) : 0,
        k < 2 ? 1<<(k+6) : 0, k > 9 ? 1<<(k-10) : 0, k > 1 && k < 10 ? 1<<(k-8) : 0,
        l < 2 ? 1<<(l+6) : 0, l > 9 ? 1<<(l-10) : 0, l > 1 && l < 10 ? 1<<(l-8) : 0,
        0x00, 0x00, 0x00,
        0x00, 0x00, 0x00,
    ]))
    i += ii
    j = (j + 1 * ii) % 18
    k = (k + 1 * ii) % 18
    l = (l + 1 * ii) % 18
    if (ii > 0 && i == 17)
        ii = -1
    else if (ii < 0 && i == 0)
        ii = +1    
}, 200)
}
</script>
<button onclick="go()">Go</button>
</body>
</html>
