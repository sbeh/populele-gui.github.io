<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Populele GUI</title>
</head>
<body>
<script>
(async () => {
const serviceUuid = '0000ffa0-0000-1000-8000-00805f9b34fb'
const characteristicUuid = '0000dc86-0000-1000-8000-00805f9b34fb'
    
let bluetoothDevice = await navigator.bluetooth.requestDevice({
    filters: [{ name: 'populele' }],
    optionalServices: [serviceUuid]
})

let bluetoothServer = await bluetoothDevice.gatt.connect()

const service = await bluetoothServer.getPrimaryService(serviceUuid)
const characteristic = await service.getCharacteristic(characteristicUuid)

let i = 0, ii = 1
setInterval(() => {
    characteristic.writeValue(new Uint8Array([
        0xf1,
        i < 8 ? 1<<i : 0, i >= 8 && i < 16 ? 1<<(i-8) : 0, i >= 16 ? 1<<(i-16) : 0,
        j < 8 ? 1<<j : 0, j >= 8 && j < 16 ? 1<<(j-8) : 0, j >= 16 ? 1<<(j-16) : 0,
        k < 8 ? 1<<k : 0, k >= 8 && k < 16 ? 1<<(k-8) : 0, k >= 16 ? 1<<(k-16) : 0,
        l < 8 ? 1<<l : 0, l >= 8 && l < 16 ? 1<<(l-8) : 0, l >= 16 ? 1<<(l-16) : 0,
        0x00, 0x00, 0x00,
        0x00, 0x00, 0x00,
    ]))
    i += ii
    j = (j + 1 * ii) % 18
    k = (k + 1 * ii) % 18
    l = (l + 1 * ii) % 18
    if (ii > 0 && i == 17)
        ii = -1
    else if (ii < 0 && i == 0)
        ii = +1    
}, 200);
))()
</script>
</body>
</html>
